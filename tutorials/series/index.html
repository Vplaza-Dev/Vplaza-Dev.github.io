<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VKF0XQGBEN"></script><script>window.dataLayer=window.dataLayer||[];const gtag=function(){dataLayer.push(arguments)};gtag("js",new Date),gtag("config","G-VKF0XQGBEN");</script><meta name="robots" content="noindex">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Heartive - Series</title>
    <meta name="description" content="Trending shows (with an epic search bar!!)">

    <link rel="icon" href="../previews/branding/favicon-128x128.png"/>
    <link rel="apple-touch-icon" sizes="180x180" href="../previews/branding/favicon-180x180.png"/>
    <link rel="icon" type="image/png" sizes="32x32" href="../previews/branding/favicon-32x32.png"/>
    <link rel="icon" type="image/png" sizes="16x16" href="../previews/branding/favicon-16x16.png"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet"/>

    <script src="https://cdn.jsdelivr.net/npm/slugify@1.6.6/slugify.min.js"></script>
    <script src="../cachedFetch.js"></script>
    <script src="../utils.js"></script>
    <style>
        :root {
            --netflix-red: #e50914;
            --netflix-dark: #141414;
            --netflix-light-dark: #181818;
            --netflix-darker: #0b0b0b;
            --netflix-light-text: #e5e5e5;
            --netflix-gray: #808080;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            color: var(--netflix-light-text);
            background-color: var(--netflix-dark);
            margin: 0;
            padding: 0;
            font-family: 'Open Sans', sans-serif;
            overflow-x: hidden;
        }

        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0) 100%);
            padding: 20px 4%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s;
        }

        header.scrolled {
            background-color: var(--netflix-dark);
        }

        .logo {
            display: flex;
            align-items: center;
        }

        .logo img.emoji {
            width: 25px;
            height: 25px;
            margin-right: 8px;
        }

        .logo h1 {
            margin: 0;
            font-size: 22px;
            font-weight: 700;
            color: var(--netflix-red);
        }

        .spacer {
            height: 68px;
        }

        main {
            padding: 0 4%;
        }

        .section-title {
            font-size: 24px;
            font-weight: 700;
            margin: 30px 0 15px;
            color: var(--netflix-light-text);
        }

        #videoGrid, #searchResults {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin-bottom: 40px;
        }

        @media (max-width: 1400px) {
            #videoGrid, #searchResults {
                grid-template-columns: repeat(5, 1fr);
            }
        }

        @media (max-width: 1100px) {
            #videoGrid, #searchResults {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (max-width: 800px) {
            #videoGrid, #searchResults {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 600px) {
            #videoGrid, #searchResults {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 400px) {
            #videoGrid, #searchResults {
                grid-template-columns: repeat(1, 1fr);
            }
        }

        .videoItem {
            position: relative;
            cursor: pointer;
            transition: transform 0.3s ease, z-index 0.3s ease;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 5px;
        }

        .videoItem:hover {
            transform: scale(1.1);
            z-index: 10;
        }

        .videoItem:hover .content-info {
            opacity: 1;
            transform: translateY(0);
        }

        .thumbnail {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 150%;
            overflow: hidden;
        }

        .thumbnail img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: opacity 0.3s;
        }

        .content-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.5) 60%, rgba(0,0,0,0) 100%);
            padding: 60px 10px 10px;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s, transform 0.3s;
        }

        .content-info h3 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .content-info p {
            font-size: 12px;
            color: var(--netflix-gray);
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            max-height: 54px;
        }

        .networks {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            z-index: 2;
        }

        .networks a {
            color: white;
            text-decoration: none;
        }

        .dateOverlay {
            position: absolute;
            bottom: 10px;
            left: 10px;
            color: white;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 2px 6px;
            border-radius: 2px;
            font-size: 12px;
            z-index: 2;
        }

        .ratingOverlay {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 2px 6px;
            border-radius: 2px;
            font-size: 12px;
            z-index: 2;
        }

        .playIcon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
        }

        .videoItem:hover .playIcon {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        #search-container {
            display: flex;
            align-items: center;
            position: relative;
        }

        #search-input-container {
            display: flex;
            align-items: center;
            position: relative;
            background-color: rgba(0, 0, 0, 0.75);
            border: 1px solid var(--netflix-gray);
            border-radius: 4px;
            overflow: hidden;
            transition: width 0.3s ease, border-color 0.3s;
            width: 240px;
        }

        #search-input-container:focus-within {
            border-color: white;
            width: 280px;
        }

        #search-input-container img {
            width: 16px;
            height: 16px;
            margin-left: 10px;
            filter: brightness(0) invert(1);
            opacity: 0.7;
        }

        #searchInput {
            background-color: transparent;
            border: none;
            outline: none;
            color: white;
            padding: 8px 12px;
            width: 100%;
            font-size: 14px;
        }

        #searchInput::placeholder {
            color: var(--netflix-gray);
        }

        .nav-items {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .separator {
            height: 20px;
            border-top: 1px solid #808080;
            opacity: 0.5;
            margin: 15px 0;
        }

        a {
            color: var(--netflix-light-text);
            text-decoration: none;
        }

        /* Netflix hover animation effect */
        .row {
            position: relative;
            width: 100%;
            padding: 0 4%;
            margin-bottom: 30px;
        }

        .row-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .row-title {
            font-size: 22px;
            font-weight: bold;
            color: var(--netflix-light-text);
        }

        .loaded-indicator {
            font-size: 12px;
            color: var(--netflix-red);
            letter-spacing: 0.5px;
            opacity: 0.75;
        }

        /* Netflix style loading animation */
        .netflix-loader {
            width: 100%;
            height: 4px;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 2000;
            background: var(--netflix-dark);
            overflow: hidden;
        }

        .netflix-loader::after {
            content: '';
            width: 40%;
            height: 100%;
            background: var(--netflix-red);
            position: absolute;
            top: 0;
            left: -40%;
            animation: netflix-loading 1.5s infinite ease-in-out;
        }

        @keyframes netflix-loading {
            0% { left: -40%; }
            100% { left: 100%; }
        }
    </style>
</head>
<body>
    <div class="netflix-loader" id="netflixLoader"></div>
    <header id="mainHeader">
        <div class="logo">
            <a href="/">
                <h1 style="display: flex; align-items: center;">
                    <img draggable="false" class="emoji" alt="" src="../previews/branding/favicon-128x128.png">
                    HEARTIVE
                </h1>
            </a>
        </div>
        <div class="nav-items">
            <div id="search-container">
                <div id="search-input-container">
                    <img src="../previews/icons/magnifying_glass.png" alt=""/>
                    <input type="text" id="searchInput" placeholder="Titles, people, genres"/>
                </div>
            </div>
        </div>
    </header>
    <div class="spacer"></div>

    <main>
        <div id="searchResults"></div>

        <div id="searchResultsSection" style="display: none;">
            <h2 class="section-title">Search Results</h2>
            <div id="searchResultsContainer"></div>
        </div>

        <div id="popularSection">
            <h2 class="section-title">Popular on Heartive</h2>
            <div id="videoGrid"></div>
        </div>
    </main>

    <script>
        // Show/hide Netflix loader
        const netflixLoader = document.getElementById('netflixLoader');
        window.addEventListener('load', () => {
            setTimeout(() => {
                netflixLoader.style.display = 'none';
            }, 500);
        });

        // Header background on scroll
        const header = document.getElementById('mainHeader');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 10) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });

        // Original functionality preserved
        let searchInput = document.getElementById("searchInput");
        let videoGrid = document.getElementById("videoGrid");
        let searchResults = document.getElementById("searchResults");
        let searchResultsSection = document.getElementById("searchResultsSection");
        let searchResultsContainer = document.getElementById("searchResultsContainer");

        var currentPage = 3;

        async function get(e) {
            return themoviedb(`trending/tv/week?language=${getTmdbLanguage()}&page=` + e)
                .then(e => e.json())
                .then(e => e.results);
        }

        function getImage(e) {
            return null == e ? "../previews/no-poster.png" : "https://image.tmdb.org/t/p/" + getTmdbImageQuality() + e;
        }

        function create(e, t) {
            // Create Netflix-style card
            var a = document.createElement("div");
            a.classList.add("videoItem");

            let n = document.createElement("a");
            n.classList.add("thumbnail");
            n.setAttribute("href", `../seasons/#/${tvSlugify(e.name, e.original_name)}/` + e.id);

            var r = document.createElement("img");
            r.loading = "lazy";
            r.src = getImage(e.poster_path);
            n.appendChild(r);

            var playIcon = document.createElement("div");
            playIcon.classList.add("playIcon");
            playIcon.innerHTML = "<i class='fas fa-play'></i>";
            n.appendChild(playIcon);

            let i = document.createElement("div");
            i.classList.add("dateOverlay");
            i.innerText = e.first_air_date.split("-")[0];
            n.appendChild(i);
            i.addEventListener("click", e => {
                e.stopPropagation()
            });

            if (e.vote_average) {
                r = document.createElement("div");
                r.classList.add("ratingOverlay");
                r.innerHTML = oranj('<i class="fas fa-star"></i>') + " " + e.vote_average.toFixed(1);
                n.appendChild(r);
                r.addEventListener("click", e => {
                    e.stopPropagation()
                });
            }

            // Content info for Netflix hover effect
            const contentInfo = document.createElement("div");
            contentInfo.classList.add("content-info");

            const title = document.createElement("h3");
            title.innerText = e.name;
            contentInfo.appendChild(title);

            const overview = document.createElement("p");
            overview.innerText = e.overview;
            contentInfo.appendChild(overview);

            n.appendChild(contentInfo);

            // Fetch additional TV show data
            themoviedb(`tv/${e.id}?language=` + getTmdbLanguage())
                .then(e => e.json())
                .then(e => {
                    var t, a;
                    if ("Ended" === e?.status && (t = e.first_air_date.split("-")[0]) !== (a = e.last_air_date.split("-")[0])) {
                        i.innerText = t + "-" + a;
                    }
                    if (e.networks && e.networks.length > 0 && e.homepage) {
                        t = document.createElement("div");
                        t.classList.add("networks");
                        n.appendChild(t);
                        a = document.createElement("a");
                        a.href = e.homepage;
                        a.target = "_blank";
                        a.rel = "noopener noreferrer";
                        a.textContent = e.networks[e.networks.length - 1].name;
                        t.appendChild(a);
                    }
                });

            a.appendChild(n);
            a.setAttribute("id", "tmdb-" + e.id.toString());

            // Add to the correct container
            (t ? searchResultsContainer : videoGrid).appendChild(a);
        }

        async function display() {
            let e = [];
            for (var t = 1; t <= currentPage; t++) {
                var a = await get(t);
                e = e.concat(a);
            }
            e.filter(e => !inFuture(e.first_air_date)).forEach(e => {
                create(e);
            });
        }

        let searchTimeout;
        searchInput.addEventListener("input", async () => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                const searchTerm = searchInput.value.trim();

                if (searchTerm.length > 0) {
                    // Show search results section, hide popular section
                    searchResultsSection.style.display = "block";
                    popularSection.style.display = "none";

                    // Clear previous results
                    searchResultsContainer.innerHTML = "";

                    // Fetch and display results
                    themoviedb(`search/tv?query=${searchTerm}&include_adult=false&language=` + getTmdbLanguage())
                        .then(e => e.json())
                        .then(async e => {
                            e.results.filter(e => !inFuture(e.first_air_date)).forEach(e => {
                                create(e, true);
                            });
                        });
                } else {
                    // Hide search results, show popular section
                    searchResultsSection.style.display = "none";
                    popularSection.style.display = "block";
                }
            }, 500);
        });

        window.addEventListener("scroll", async () => {
            if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 200) {
                for (var e = (currentPage += 3) - 2; e <= currentPage; e++) {
                    (await get(e))
                        .filter(e => !inFuture(e.first_air_date) && !document.getElementById("tmdb-" + e.id.toString()))
                        .forEach(e => {
                            create(e, false);
                        });
                }
            }
        });

        display();
    </script>

    <!-- Cloudflare Pages Analytics -->
    <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "e70a405a52eb428db253911f5e45d760"}'></script>
    <!-- Cloudflare Pages Analytics -->
</body>
</html>
