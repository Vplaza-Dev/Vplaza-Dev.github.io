<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>YouTube Music Player</title>
	<link rel="stylesheet" href="style.css">
</head>

<body>
	<div id="searchContainer">
		<input type="text" id="searchInput" placeholder="Search for music..." />
		<button onclick="searchSong()">Search</button>
	</div>

	<div id="resultsContainer"></div>

	<div id="videoContainer" style="display: none;">
		<div id="player"></div>
		<div id="controls">
			<button onclick="togglePlayPause()">Play</button>
			<p id="currentTime">00:00</p>
		</div>
	</div>

	<!-- Sticky Play/Pause Button -->
	<div id="stickyControls">
		<button id="playPauseButton" onclick="togglePlayPause()">Play</button>
	</div>

	<!-- Small Video Frame -->
	<div id="smallVideoFrame">
		<iframe id="smallVideo" src="" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
	</div>

	<script src="https://www.youtube.com/iframe_api"></script>
	<script>let player;
let currentVideoId = '';
let isPlaying = false; // Variable to track if the video is playing

function onYouTubeIframeAPIReady() {
  player = new YT.Player('player', {
    height: '180', // Larger height for the video
    width: '320',  // Larger width for the video
    videoId: '',
    playerVars: {
      controls: 0, // Hide YouTube controls
      modestbranding: 1, // Hide YouTube logo from the player
      rel: 0, // Disable related videos at the end of the video
      showinfo: 0, // Hide the video info (title, uploader)
      iv_load_policy: 3, // Disable annotations
      fs: 1, // Show fullscreen button
      disablekb: 1, // Disable keyboard controls
      autoplay: 1, // Enable autoplay
    },
    events: {
      'onReady': onPlayerReady,
      'onStateChange': onPlayerStateChange
    }
  });
}

function onPlayerReady(event) {
  console.log("Player is ready");
}

function onPlayerStateChange(event) {
  if (event.data == YT.PlayerState.PLAYING) {
    // Update play/pause button if the video is playing
    isPlaying = true;
    document.getElementById('playPauseButton').textContent = 'Pause';
    setInterval(updateCurrentTime, 1000); // Update current time every second
  } else if (event.data == YT.PlayerState.PAUSED) {
    // Update play/pause button if the video is paused
    isPlaying = false;
    document.getElementById('playPauseButton').textContent = 'Play';
  }
}

function searchSong() {
  const query = document.getElementById('searchInput').value;
  const apiKey = 'AIzaSyBQAZ7-zXoAFYBBDp9Amddor0WAooSjUaM'; // Get this from Google Developer Console
  const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${query}&type=video&key=${apiKey}`;

  fetch(url)
    .then(response => response.json())
    .then(data => displayResults(data.items))
    .catch(error => console.error('Error fetching data:', error));
}

function displayResults(videos) {
  const resultsContainer = document.getElementById('resultsContainer');
  resultsContainer.innerHTML = ''; // Clear previous results

  const ul = document.createElement('ul'); // Create an unordered list

  videos.forEach(video => {
    const li = document.createElement('li'); // Create a list item for each video
    li.classList.add('video-item'); // Optional, for styling

    li.innerHTML = `
      <img src="${video.snippet.thumbnails.default.url}" alt="${video.snippet.title}" class="video-thumbnail">
      <p class="video-title">${video.snippet.title}</p>
      <button onclick="playVideo('${video.id.videoId}')">Play</button>
    `;

    ul.appendChild(li); // Append each video as a list item
  });

  resultsContainer.appendChild(ul); // Append the unordered list to the container
}

function playVideo(videoId) {
  currentVideoId = videoId;
  player.loadVideoById(videoId);
  document.getElementById('videoContainer').style.display = 'block';
  document.getElementById('smallVideoFrame').style.display = 'none'; // Hide small video frame when playing a new video
}

function togglePlayPause() {
  if (isPlaying) {
    player.pauseVideo();
  } else {
    player.playVideo();
  }
}

function updateCurrentTime() {
  const currentTime = player.getCurrentTime();
  const minutes = Math.floor(currentTime / 60);
  const seconds = Math.floor(currentTime % 60);
  document.getElementById('currentTime').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
}
</script> 
</body>

</html>
